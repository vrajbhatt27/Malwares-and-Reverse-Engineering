from Crypto.Cipher import PKCS1_OAEP
from Crypto.PublicKey import RSA


key = "12345".encode()

pub_pem = """-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCM5PWv1gFLUv4xjcjeavgcVe9p
a0kZlqw/+y7/d7AdZRSHY4sC7shQAtJlN4YBoEJq7OqELejEjo7aLVEs+wWU3lGH
2O9BvRV42ttyUKKdl03l4gqewYiELhyxoK/1VOXz3PU+lRuSeq1OXes+SvM5Og/4
Aof/HtBcs3cSou96swIDAQAB
-----END PUBLIC KEY-----
    """

pub_key = RSA.importKey(pub_pem)
encryptor = PKCS1_OAEP.new(key=pub_key)
encrypted_sym_key = encryptor.encrypt(key)

print(encrypted_sym_key.decode())

cipher = input("Enter: ")
prv_key = RSA.importKey(open("C:/Users/91982/Desktop/SGP-sem 5/privateKey.pem", "r").read())
decryptor = PKCS1_OAEP.new(key=prv_key)

data = decryptor.decrypt(cipher)
print(data)




