import os
import Ransomware as r


def decrypt(path):
    with open("C:/Users/k4li/Desktop/key.txt", "rb") as file:
        key = file.read()

    print(key)

    rw = r.Ransomeware(key)

    for cp, dir_n, file in os.walk(path):
        for i in file:
            if i.endswith(".encrypted"):
                with open(cp + "/" + i, "rb") as f:
                    data = f.read()

                msg = rw.decrypt_data(data)
                msg  = msg

                ext = os.path.splitext(i)
                with open(cp + "/" + ext[0], "wb") as f:
                    f.write(msg)

                os.remove(cp + "/" + i)





decrypt("C:/Users/k4li/Desktop/Test")



"""
 with open("C:/Users/91982/Desktop/SGP-sem 5/key.txt", "rb") as file:
        encrypted_sym_key = file.read()

    prv_key = RSA.importKey(open("C:/Users/91982/Desktop/SGP-sem 5/privateKey.pem","r").read())
    decryptor = PKCS1_OAEP.new(key=prv_key)

    key = decryptor.decrypt(encrypted_sym_key)
"""
